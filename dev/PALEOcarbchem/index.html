<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PALEOcarbchem · PALEOaqchem Documentation</title><meta name="title" content="PALEOcarbchem · PALEOaqchem Documentation"/><meta property="og:title" content="PALEOcarbchem · PALEOaqchem Documentation"/><meta property="twitter:title" content="PALEOcarbchem · PALEOaqchem Documentation"/><meta name="description" content="Documentation for PALEOaqchem Documentation."/><meta property="og:description" content="Documentation for PALEOaqchem Documentation."/><meta property="twitter:description" content="Documentation for PALEOaqchem Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PALEOaqchem Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">PALEOaqchem.jl</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../PALEOaqchem Reactions/">PALEOaqchem Reactions</a></li><li><a class="tocitem" href="../PALEOaqchem functions/">PALEOaqchem functions</a></li><li class="is-active"><a class="tocitem" href>PALEOcarbchem</a><ul class="internal"><li><a class="tocitem" href="#Inputs-and-equilibrium-constants"><span>Inputs and equilibrium constants</span></a></li><li><a class="tocitem" href="#Solvers-and-outputs"><span>Solvers and outputs</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../References/">References</a></li><li><a class="tocitem" href="../indexpage/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>PALEOcarbchem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PALEOcarbchem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/main/docs/src/PALEOcarbchem.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PALEOcarbchem"><a class="docs-heading-anchor" href="#PALEOcarbchem">PALEOcarbchem</a><a id="PALEOcarbchem-1"></a><a class="docs-heading-anchor-permalink" href="#PALEOcarbchem" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem" href="#PALEOaqchem.PALEOcarbchem"><code>PALEOaqchem.PALEOcarbchem</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">PALEOcarbchem</code></pre><p>Carbonate chemistry equilibrium translated from Matlab CO2SYS v1.1 (<a href="../References/#VanHeuven2011">van Heuven <em>et al.</em>, 2011</a>), (<a href="../References/#Lewis1998">Lewis and Wallace, 1998</a>) and refactored for speed.</p><p>Implementation based on CO2SYS constants, with reimplemented equilibrium calculation.</p><p>NB: </p><ul><li>Although effective equilibrium constants can be calculated for different pH scales, TAlk or pH calculations using <a href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>PALEOcarbchem.calculateTAfromTCpHfree!</code></a></li></ul><p>require constants to be on the free pH scale.</p><ul><li>Effective equilibrium constants are empirical measurements hence are only accurate for modern seawater composition.</li></ul><p><strong>Example usage with default choice of constants, all components enabled:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; PALEOcarbchem.ComponentsAllStrings  # all available components
(&quot;Ci&quot;, &quot;S&quot;, &quot;F&quot;, &quot;B&quot;, &quot;P&quot;, &quot;Si&quot;, &quot;H2S&quot;, &quot;NH3&quot;, &quot;Omega&quot;)

julia&gt; comps, concinputs = PALEOcarbchem.get_components_inputs([&quot;Ci&quot;, &quot;S&quot;, &quot;F&quot;, &quot;B&quot;, &quot;P&quot;, &quot;Si&quot;, &quot;H2S&quot;, &quot;NH3&quot;, &quot;Omega&quot;])
((Ci = Val{true}(), S = Val{true}(), F = Val{true}(), B = Val{true}(), P = Val{true}(), Si = Val{true}(), H2S = Val{true}(), NH3 = Val{true}(), Omega = Val{true}()), [&quot;TCi&quot;, &quot;TS&quot;, &quot;TF&quot;, &quot;TB&quot;, &quot;TP&quot;, &quot;TSi&quot;, &quot;TH2S&quot;, &quot;TNH3&quot;, &quot;Ca&quot;])

julia&gt; println(concinputs) # concentrations required (in addition to TAlk)
[&quot;TCi&quot;, &quot;TS&quot;, &quot;TF&quot;, &quot;TB&quot;, &quot;TP&quot;, &quot;TSi&quot;, &quot;TH2S&quot;, &quot;TNH3&quot;, &quot;Ca&quot;]  

julia&gt; options = (; WhichKs=Val(10), WhoseKSO4=Val(1), pHScale=Val(3), Components=comps)
(WhichKs = Val{10}(), WhoseKSO4 = Val{1}(), pHScale = Val{3}(), Components = (Ci = Val{true}(), S = Val{true}(), F = Val{true}(), B = Val{true}(), P = Val{true}(), Si = Val{true}(), H2S = Val{true}(), NH3 = Val{true}(), Omega = Val{true}()))

julia&gt; C = zeros(length(PALEOcarbchem.ConstNames));

julia&gt; PALEOcarbchem.calc_constants!(C, 25.0, 1000.0, 35.0, Options=options) # Temp(C), P(dbar), Sal(psu)

julia&gt; C_NT = NamedTuple{PALEOcarbchem.ConstNames}(C);  # convert to NamedTuple for convenience

julia&gt; map(x -&gt; @sprintf(&quot;%.14e&quot;, x), C_NT)
(TF = &quot;6.83258396883673e-05&quot;, TS = &quot;2.82354341328601e-02&quot;, fH = &quot;7.13404318750000e-01&quot;, VPFac = &quot;9.69344700036820e-01&quot;, KW = &quot;5.12594224560177e-14&quot;, KF = &quot;2.46750587115740e-03&quot;, KS = &quot;1.07228495518292e-01&quot;, K0 = &quot;2.83918818040155e-02&quot;, K1 = &quot;1.23204547404511e-06&quot;, K2 = &quot;9.14637929020938e-10&quot;, FugFac = &quot;9.96810458692103e-01&quot;, KB = &quot;2.23064975910959e-09&quot;, KP1 = &quot;2.01400858730558e-02&quot;, KP2 = &quot;9.31686820250764e-07&quot;, KP3 = &quot;1.40307711726248e-09&quot;, KSi = &quot;3.62200612635021e-10&quot;, KH2S = &quot;2.60000514374855e-07&quot;, KNH3 = &quot;4.74226503827862e-10&quot;, KCa = &quot;4.92763187414538e-07&quot;, KAr = &quot;7.39194729649679e-07&quot;)

julia&gt; modern_concs = PALEOcarbchem.calc_modern_default_concs(35.0, Options=options);

julia&gt; map(x -&gt; @sprintf(&quot;%.14e&quot;, x), modern_concs)
(TF = &quot;6.83258396883673e-05&quot;, TS = &quot;2.82354341328601e-02&quot;, TB = &quot;4.15700000000000e-04&quot;, Ca = &quot;1.02845697008497e-02&quot;)

julia&gt; input_concs = (TCi=[2000e-6], TS=[modern_concs.TS], TF=[modern_concs.TF], TSi=[1e-3], TP=[1e-6],  TB=[modern_concs.TB], TH2S=[1e-6], TNH3=[1e-6], Ca=[modern_concs.Ca]);  # all in mol kg-1

julia&gt; res = zeros(length(PALEOcarbchem.ResultNames));

julia&gt; (pHfree, steps) = PALEOcarbchem.calculatepHfromTATC!(res, C, options, 2300e-6, input_concs);

julia&gt; @printf(&quot;%.14f&quot;, pHfree)
8.04695972423890

julia&gt; steps
5

julia&gt; res_NT = NamedTuple{PALEOcarbchem.ResultNames}(res); # convert to NamedTuple for convenience

julia&gt; map(x -&gt; @sprintf(&quot;%.14e&quot;, x), res_NT)
(pHfree = &quot;8.04695972423890e+00&quot;, H = &quot;8.97512024441008e-09&quot;, OH = &quot;5.71127974446284e-06&quot;, TA = &quot;2.30000000000000e-03&quot;, dTAdpH = &quot;6.71952166583155e-04&quot;, TS = &quot;2.82354341328601e-02&quot;, HSO4 = &quot;2.36333069917159e-09&quot;, TF = &quot;6.83258396883673e-05&quot;, HF = &quot;2.48522365702671e-10&quot;, TCi = &quot;2.00000000000000e-03&quot;, CO2 = &quot;1.31351930129921e-05&quot;, HCO3 = &quot;1.80311290118315e-03&quot;, CO3 = &quot;1.83751905803853e-04&quot;, CAlk = &quot;2.17061671279086e-03&quot;, fCO2 = &quot;4.62639042514413e-04&quot;, pCO2 = &quot;4.64119370418157e-04&quot;, xCO2dryinp = &quot;4.78797037215479e-04&quot;, TB = &quot;4.15700000000000e-04&quot;, BAlk = &quot;8.27503245712347e-05&quot;, TP = &quot;1.00000000000000e-06&quot;, H3PO4 = &quot;3.68183719676091e-15&quot;, H2PO4 = &quot;8.26200822875433e-09&quot;, HPO4 = &quot;8.57660283752523e-07&quot;, PO4 = &quot;1.34077704336885e-07&quot;, PengCorrection = &quot;0.00000000000000e+00&quot;, PAlk = &quot;1.12581568874446e-06&quot;, TSi = &quot;1.00000000000000e-03&quot;, SiAlk = &quot;3.87906357916080e-05&quot;, TH2S = &quot;1.00000000000000e-06&quot;, HSAlk = &quot;9.66632218352735e-07&quot;, TNH3 = &quot;1.00000000000000e-06&quot;, NH3Alk = &quot;5.01861680455629e-08&quot;, Ca = &quot;1.02845697008497e-02&quot;, OmegaCA = &quot;3.83512675291204e+00&quot;, OmegaAR = &quot;2.55657840498853e+00&quot;)

julia&gt; pHtot = PALEOcarbchem.mappHscale(C, pHfree, Val(3), Val(1), res_NT.TS, res_NT.TF);

julia&gt; @printf(&quot;%.14f&quot;, pHtot)
7.94544626702045</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/PALEOcarbchem.jl#L1-L63">source</a></section></article><h2 id="Inputs-and-equilibrium-constants"><a class="docs-heading-anchor" href="#Inputs-and-equilibrium-constants">Inputs and equilibrium constants</a><a id="Inputs-and-equilibrium-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs-and-equilibrium-constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.ComponentsAll" href="#PALEOaqchem.PALEOcarbchem.ComponentsAll"><code>PALEOaqchem.PALEOcarbchem.ComponentsAll</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">ComponentsAll::NamedTuple
ComponentsAllStrings::Vector{String}</code></pre><p>All available components</p><pre><code class="language-julia-repl hljs">julia&gt; PALEOcarbchem.ComponentsAll
(Ci = Val{true}(), S = Val{true}(), F = Val{true}(), B = Val{true}(), P = Val{true}(), Si = Val{true}(), H2S = Val{true}(), NH3 = Val{true}(), Omega = Val{true}())

julia&gt; PALEOcarbchem.ComponentsAllStrings  # all available components
(&quot;Ci&quot;, &quot;S&quot;, &quot;F&quot;, &quot;B&quot;, &quot;P&quot;, &quot;Si&quot;, &quot;H2S&quot;, &quot;NH3&quot;, &quot;Omega&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.get_components_inputs" href="#PALEOaqchem.PALEOcarbchem.get_components_inputs"><code>PALEOaqchem.PALEOcarbchem.get_components_inputs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_components_inputs(compstoenable) -&gt; (components::NamedTuple, concinputs::Vector{String})</code></pre><p>Returns <code>components</code> and <code>concinputs</code> required for specified <code>compstoenable</code></p><p><code>compstoenable</code> is a list (Vector or Tuple) with component names as Strings, eg [&quot;Ci&quot;, &quot;B&quot;, &quot;Si&quot;] </p><p>Returns:</p><ul><li>a NamedTuple <code>components</code> with those components present in <code>compstoenable</code> as <code>Val{true}</code> and others as <code>Val{false}</code></li><li>a Vector <code>concinputs</code> of input concentrations required (P requires TP etc).</li></ul><p><strong>Examples</strong></p><p>All components:</p><pre><code class="language-julia-repl hljs">julia&gt; compsall, concinputsall = PALEOcarbchem.get_components_inputs([&quot;Ci&quot;, &quot;S&quot;, &quot;F&quot;, &quot;B&quot;, &quot;P&quot;, &quot;Si&quot;, &quot;H2S&quot;, &quot;NH3&quot;, &quot;Omega&quot;])
((Ci = Val{true}(), S = Val{true}(), F = Val{true}(), B = Val{true}(), P = Val{true}(), Si = Val{true}(), H2S = Val{true}(), NH3 = Val{true}(), Omega = Val{true}()), [&quot;TCi&quot;, &quot;TS&quot;, &quot;TF&quot;, &quot;TB&quot;, &quot;TP&quot;, &quot;TSi&quot;, &quot;TH2S&quot;, &quot;TNH3&quot;, &quot;Ca&quot;])

julia&gt; compsall
(Ci = Val{true}(), S = Val{true}(), F = Val{true}(), B = Val{true}(), P = Val{true}(), Si = Val{true}(), H2S = Val{true}(), NH3 = Val{true}(), Omega = Val{true}())

julia&gt; println(concinputsall) # concentrations required (in addition to TAlk)
[&quot;TCi&quot;, &quot;TS&quot;, &quot;TF&quot;, &quot;TB&quot;, &quot;TP&quot;, &quot;TSi&quot;, &quot;TH2S&quot;, &quot;TNH3&quot;, &quot;Ca&quot;]</code></pre><p>All optional components disabled (just H2O)</p><pre><code class="language-julia-repl hljs">julia&gt; compsminimal, concinputsminimal = PALEOcarbchem.get_components_inputs([])
((Ci = Val{false}(), S = Val{false}(), F = Val{false}(), B = Val{false}(), P = Val{false}(), Si = Val{false}(), H2S = Val{false}(), NH3 = Val{false}(), Omega = Val{false}()), String[])

julia&gt; println(concinputsminimal)
String[]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L30-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.ConstNames" href="#PALEOaqchem.PALEOcarbchem.ConstNames"><code>PALEOaqchem.PALEOcarbchem.ConstNames</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">ConstNames::Tuple</code></pre><p>All available CO2SYS effective equilibrium constant names</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.CNameIdx" href="#PALEOaqchem.PALEOcarbchem.CNameIdx"><code>PALEOaqchem.PALEOcarbchem.CNameIdx</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">CNameIdx::NamedTuple</code></pre><p>Indices of constants in a Vector of length(<a href="#PALEOaqchem.PALEOcarbchem.ConstNames"><code>ConstNames</code></a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L123-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.getConstDescription" href="#PALEOaqchem.PALEOcarbchem.getConstDescription"><code>PALEOaqchem.PALEOcarbchem.getConstDescription</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getConstDescription(constName::AbstractString) -&gt; (constName, units, description)</code></pre><p>Get human-readable description of <code>constName</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L130-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calc_constants!" href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>PALEOaqchem.PALEOcarbchem.calc_constants!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_constants!(
    Cout, TempC_input, Pdbar, Sal_input; 
    Options=(; WhichKs=Val(10), WhoseKSO4=Val(1), pHScale=Val(3), Components=ComponentsAll))</code></pre><p>Calculate carbonate chemistry constants, results are returned in <code>Cout</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>Cout::Vector</code>:  (output) Vector of length length(<a href="#PALEOaqchem.PALEOcarbchem.ConstNames"><code>ConstNames</code></a>) with calculated equilibrium constants</li><li><code>TempC_input</code>:  temperature deg C. Will be limited to valid range for constants in use (from <a href="#PALEOaqchem.PALEOcarbchem.calc_limits"><code>calc_limits</code></a>)</li><li><code>Pdbar</code>:  pressure, dbar. </li><li><code>Sal_input</code>:      salinity.   Will be limited to valid range for constants in use (from <a href="#PALEOaqchem.PALEOcarbchem.calc_limits"><code>calc_limits</code></a>)</li><li><code>Options</code>: NamedTuple with fields:<ul><li><code>WhichKs</code>: Val(Int), default Val(10) </li><li><code>WhoseKSO4</code>:  Val(Int), default Val(1) </li><li><code>pHScale</code>:  Val(Int), default Val(3) (free - required for <a href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>calculateTAfromTCpHfree!</code></a>)</li><li><code>Components</code>: components to enable as generated by <a href="#PALEOaqchem.PALEOcarbchem.get_components_inputs"><code>get_components_inputs</code></a>      </li></ul></li></ul><p><strong>WhichKs:</strong></p><p>K1 K2 dissociation constants that are to be used. Val(Int) where Int is:</p><ul><li>1 = Roy, 1993											T:    0-45  S:  5-45. Total scale. Artificial seawater.</li><li>2 = Goyet &amp; Poisson										T:   -1-40  S: 10-50. Seaw. scale. Artificial seawater.</li><li>3 = HANSSON              refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>4 = MEHRBACH             refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>5 = HANSSON and MEHRBACH refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>6 = GEOSECS (i.e., original Mehrbach)					T:    2-35  S: 19-43. NBS scale.   Real seawater.</li><li>7 = Peng	(i.e., originam Mehrbach but without XXX)	T:    2-35  S: 19-43. NBS scale.   Real seawater.</li><li>8 = Millero, 1979, FOR PURE WATER ONLY (i.e., Sal=0)	T:    0-50  S:     0.</li><li>9 = Cai and Wang, 1998									T:    2-35  S:  0-49. NBS scale.   Real and artificial seawater.</li><li>10 = Lueker et al, 2000									T:    2-35  S: 19-43. Total scale. Real seawater.</li><li>11 = Mojica Prieto and Millero, 2002.					T:    0-45  S:  5-42. Seaw. scale. Real seawater</li><li>12 = Millero et al, 2002									T: -1.6-35  S: 34-37. Seaw. scale. Field measurements.</li><li>13 = Millero et al, 2006									T:    0-50  S:  1-50. Seaw. scale. Real seawater.</li><li>14 = Millero et al, 2010									T:    0-50  S:  1-50. Seaw. scale. Real seawater.</li></ul><p><strong><code>WhichKs=Val(10)</code> (Lueker etal (2000) parameters.)</strong></p><p>Recommended as &#39;best practice&#39; by Dickson (2007)  (as cited in Orr, J. C., Epitalon, J-M., &amp; Gattuso, J-P. (2014).  Comparison of seven packages that compute ocean carbonate chemistry.  Biogeosciences Discussions, 11(4), 5327�5397. doi:10.5194/bgd-11-5327-2014 )</p><p><strong>WhoseKSO4:</strong></p><p>KSO4 dissociation constants that are to be used, in combination with the formulation of the borate-to-salinity ratio to be used. Having both these choices in a single argument is somewhat awkward, but it maintains syntax compatibility with the previous version. Val(Int) where Int is:</p><ul><li>1 = KSO4 of Dickson &amp; TB of Uppstrom 1979  (PREFERRED)</li><li>2 = KSO4 of Khoo    &amp; TB of Uppstrom 1979</li><li>3 = KSO4 of Dickson &amp; TB of Lee 2010</li><li>4 = KSO4 of Khoo    &amp; TB of Lee 2010</li></ul><p><strong>pHScale: Set pH scale.</strong></p><p>Val(Int) where Int is:</p><ul><li>1 = Total scale</li><li>2 = Seawater scale</li><li>3 = Free scale   [required for PALEOcarbchem solvers]</li><li>4 = NBS scale</li></ul><p><strong>Implementation</strong></p><p>Modified CO2SYS Constants, split into functions for maintainability</p><p><strong>Comments from the original code:</strong></p><pre><code class="nohighlight hljs">% SUB Constants, version 04.01, 10-13-97, written by Ernie Lewis.
% Inputs: pHScale%, WhichKs%, WhoseKSO4%, Sali, TempCi, Pdbar
% Outputs: K0, K(), T(), fH, FugFac, VPFac
% This finds the Constants of the CO2 system in seawater or freshwater,
% corrects them for pressure, and reports them on the chosen pH scale.
% The process is as follows: the Constants (except KS, KF which stay on the
% free scale - these are only corrected for pressure) are
%       1) evaluated as they are given in the literature
%       2) converted to the SWS scale in mol/kg-SW or to the NBS scale
%       3) corrected for pressure
%       4) converted to the SWS pH scale in mol/kg-SW
%       5) converted to the chosen pH scale
%
%       PROGRAMMER&#39;S NOTE: all logs are log base e
%       PROGRAMMER&#39;S NOTE: all Constants are converted to the pH scale
%               pHScale% (the chosen one) in units of mol/kg-SW
%               except KS and KF are on the free scale
%               and KW is in units of (mol/kg-SW)^2</code></pre><p><strong>Julia-specific details:</strong></p><p><code>WhichKs</code>, <code>WhoseKSO4</code>, <code>pHScale</code> are passed as Types (using Val(Int)), not integer values, so that Julia can work out which constants and functions to call at compile time. Similarly, <code>Comps</code> is a Type which encodes the selection of components, so the appropriate code is generated (components included or excluded) at compile time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L165-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calc_limits" href="#PALEOaqchem.PALEOcarbchem.calc_limits"><code>PALEOaqchem.PALEOcarbchem.calc_limits</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_limits( Val{WhichKs::Int}) -&gt; (TminC, TmaxC, salmin, salmax)</code></pre><p>Return range limits for  constant set <code>WhichKs</code>:</p><ul><li>1 = Roy, 1993											T:    0-45  S:  5-45. Total scale. Artificial seawater.</li><li>2 = Goyet &amp; Poisson										T:   -1-40  S: 10-50. Seaw. scale. Artificial seawater.</li><li>3 = HANSSON              refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>4 = MEHRBACH             refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>5 = HANSSON and MEHRBACH refit BY DICKSON AND MILLERO	T:    2-35  S: 20-40. Seaw. scale. Artificial seawater.</li><li>6 = GEOSECS (i.e., original Mehrbach)					T:    2-35  S: 19-43. NBS scale.   Real seawater.</li><li>7 = Peng	(i.e., originam Mehrbach but without XXX)	T:    2-35  S: 19-43. NBS scale.   Real seawater.</li><li>8 = Millero, 1979, FOR PURE WATER ONLY (i.e., Sal=0)	T:    0-50  S:     0.</li><li>9 = Cai and Wang, 1998									T:    2-35  S:  0-49. NBS scale.   Real and artificial seawater.</li><li>10 = Lueker et al, 2000									T:    2-35  S: 19-43. Total scale. Real seawater.</li><li>11 = Mojica Prieto and Millero, 2002.					T:    0-45  S:  5-42. Seaw. scale. Real seawater</li><li>12 = Millero et al, 2002									T: -1.6-35  S: 34-37. Seaw. scale. Field measurements.</li><li>13 = Millero et al, 2006									T:    0-50  S:  1-50. Seaw. scale. Real seawater.</li><li>14 = Millero et al, 2010									T:    0-50  S:  1-50. Seaw. scale. Real seawater.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L429-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calc_modern_default_concs" href="#PALEOaqchem.PALEOcarbchem.calc_modern_default_concs"><code>PALEOaqchem.PALEOcarbchem.calc_modern_default_concs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_modern_default_concs(Sal_input, Options=(; WhichKs=Val(10), WhoseKSO4=Val(1)) -&gt; (; TF, TS, TB, Ca)</code></pre><p>Calculate modern seawater default concentrations as a function of salinity <code>Sal_input</code></p><p>See <a href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>calc_constants!</code></a> for documentation for <code>Options</code>.</p><p><strong>Returns</strong></p><pre><code class="nohighlight hljs">- TF: (mol kg-1) Total Fluorine modern value from salinity
- TS: (mol kg-1) Total Sulphate modern value from salinity
- TB: (mol kg-1) Total Boron modern value from salinity
- Ca: (mol kg-1) Ca modern value from salinity</code></pre><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; options = (; WhichKs=Val(10), WhoseKSO4=Val(1));

julia&gt; modern_concs = PALEOcarbchem.calc_modern_default_concs(35.0, Options=options);

julia&gt; map(x -&gt; @sprintf(&quot;%.14e&quot;, x), modern_concs)
(TF = &quot;6.83258396883673e-05&quot;, TS = &quot;2.82354341328601e-02&quot;, TB = &quot;4.15700000000000e-04&quot;, Ca = &quot;1.02845697008497e-02&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Constants.jl#L392-L414">source</a></section></article><h2 id="Solvers-and-outputs"><a class="docs-heading-anchor" href="#Solvers-and-outputs">Solvers and outputs</a><a id="Solvers-and-outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers-and-outputs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.ResultNames" href="#PALEOaqchem.PALEOcarbchem.ResultNames"><code>PALEOaqchem.PALEOcarbchem.ResultNames</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">ResultNames::Tuple</code></pre><p>All available CO2SYS result names</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.RNameIdx" href="#PALEOaqchem.PALEOcarbchem.RNameIdx"><code>PALEOaqchem.PALEOcarbchem.RNameIdx</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">RNameIdx::NamedTuple</code></pre><p>Indices of results in a Vector of length(<a href="#PALEOaqchem.PALEOcarbchem.ResultNames"><code>ResultNames</code></a>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.getResultDescription" href="#PALEOaqchem.PALEOcarbchem.getResultDescription"><code>PALEOaqchem.PALEOcarbchem.getResultDescription</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getResultDescription(resultName::AbstractString) -&gt; (resultName, units, description)</code></pre><p>Get human-readable description of <code>resultName</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!" href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculateTAfromTCpHfree!(res, C, Options, concs, pHfree; do_dTAdpH=Val(false)) -&gt; (TA, dTAdpH)</code></pre><p>Calculate TAlk, and speciation, given pH and conserved concentrations (total DIC, Si, P, SO4, B, F, ...)</p><p><strong>Returns:</strong></p><ul><li><code>TA</code>:  Total Alk, mol/kg-sw      </li><li><code>dTAdpH</code>: derivative, or NaN if do_dTAdpH=Val(false)</li></ul><p><strong>Arguments:</strong></p><ul><li><code>res</code>:  (output) Vector <code>res</code> of length length(<a href="#PALEOaqchem.PALEOcarbchem.ResultNames"><code>ResultNames</code></a>) with details of TA contributions etc</li><li><code>C</code>: constants from <a href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>calc_constants!</code></a>. NB: must be on Free pH scale.</li><li><code>concs::NamedTuple</code>: (mol kg-sw, NB: each element should be a Ref or length 1 Vector)  total concentrations for sulphate, fluoride, and each optional component of alkalinity enabled in <code>C</code></li><li><code>pHfree</code>: pH on free scale</li></ul><p><strong>Implementation</strong></p><p>modified from Matlab CO2SYS CalculateTAfromTCpH(TCi, pHi) to use Free pH scale</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L55-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calculatepHfromTATC!" href="#PALEOaqchem.PALEOcarbchem.calculatepHfromTATC!"><code>PALEOaqchem.PALEOcarbchem.calculatepHfromTATC!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculatepHfromTATC!(
    res, C, Options, conc_TAx, concs; 
    pHstart=8.0, pHTol=100*eps()
) -&gt; (pHfree, steps)</code></pre><p>Call <a href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>calculateTAfromTCpHfree!</code></a> to iteratively solve for pH given (i) a starting value and pH tolerance,  and (ii) Alk and conserved concentrations (total DIC, Si, P, SO4, B, F, ...)</p><p>Intended for use eg in an ocean model to enable a single Newton-Raphson step each model timestep (ie pHstart from previous value in that grid cell, pHtol set to some large number)</p><p><strong>Returns:</strong></p><ul><li><code>pHfree</code>: pH on free scale</li><li><code>steps</code>: number of Newton iterations</li></ul><p><strong>Arguments:</strong></p><ul><li><code>res</code>:  (output) Vector <code>res</code> of length length(<a href="#PALEOaqchem.PALEOcarbchem.ResultNames"><code>ResultNames</code></a>) with details of TA contributions etc</li><li><code>C</code>: constants from <a href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>calc_constants!</code></a>. NB: must be on Free pH scale.</li><li><code>conc_TAx</code>: total Alk, mol kg-sw</li><li><code>concs</code>: other input total concentrations, see <a href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>calculateTAfromTCpHfree!</code></a></li><li><code>pHstart</code>: starting value (free pH scale)</li><li><code>pHtol</code>: tolerance (accuracy required)</li></ul><p><strong>Implementation</strong></p><p>Modified from CO2SYS  SUB CalculatepHfromTATC, version 04.01, 10-13-96, written by Ernie Lewis. NB: recoded here to use <a href="#PALEOaqchem.PALEOcarbchem.calculateTAfromTCpHfree!"><code>calculateTAfromTCpHfree!</code></a>, hence works on free pH scale.</p><p>Units: mol / kg-sw </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L248-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.calculateOmega" href="#PALEOaqchem.PALEOcarbchem.calculateOmega"><code>PALEOaqchem.PALEOcarbchem.calculateOmega</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calculateOmega(C, CO3,Ca) -&gt; (OmegaCA, OmegaAR)</code></pre><p>Calculate carbonate saturation.</p><p>Returns omega, the solubility ratio, for calcite and aragonite. This is defined by: Omega = [CO3–]*[Ca++]./Ksp, where Ksp is the solubility product (either KCa or KAr).</p><p><strong>Arguments:</strong></p><ul><li>C    - constants from <a href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>calc_constants!</code></a></li><li>CO3  - carbonate ion concentration, mol/kg-sw</li><li>Ca   - calcium concentration, mol/kg-sw</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L327-L340">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PALEOaqchem.PALEOcarbchem.mappHscale" href="#PALEOaqchem.PALEOcarbchem.mappHscale"><code>PALEOaqchem.PALEOcarbchem.mappHscale</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mappHscale(C, pHin, scalein, scaleout, TS, TF) -&gt; pHout</code></pre><p>Map pH scale at pressure, temperature, salinity defined by constants C</p><p>NB: Total, SW scale are not well defined unless using default contemporary values for <code>TS</code> (sulphate) and <code>TF</code> (fluorine)</p><p><strong>Arguments:</strong></p><ul><li><code>C</code>:  constants Vector from <a href="#PALEOaqchem.PALEOcarbchem.calc_constants!"><code>calc_constants!</code></a></li><li><code>pHin</code>: input pH on scale <code>scalein</code></li><li><code>scalein</code>, <code>scaleout</code> :<ul><li>Val(1) = Total scale</li><li>Val(2) = Seawater scale</li><li>Val(3) = Free scale</li><li>not implemented: Val(4) = NBS scale</li></ul></li><li><code>TS:</code> total sulphate (mol kg-1)</li><li><code>TF:</code> total fluoride (mol kg-1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PALEOtoolkit/PALEOaqchem.jl/blob/97b27ebb41c1afb57d61a0541d74df7eb79746c6/src/PALEOcarbchem/Solvers.jl#L349-L366">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PALEOaqchem functions/">« PALEOaqchem functions</a><a class="docs-footer-nextpage" href="../References/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 28 February 2024 19:35">Wednesday 28 February 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
